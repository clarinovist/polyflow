const { PrismaClient } = require('@prisma/client');
const p = new PrismaClient();

(async () => {
    // Find journal entries on Feb 15 that touch 30000
    const acc = await p.account.findUnique({ where: { code: '30000' } });
    const lines = await p.journalLine.findMany({
        where: {
            accountId: acc.id,
            journalEntry: {
                entryDate: { gte: new Date('2026-02-14') }
            }
        },
        include: {
            journalEntry: {
                include: {
                    lines: { include: { account: true } }
                }
            }
        }
    });

    lines.forEach(l => {
        const je = l.journalEntry;
        console.log('=== ' + (je.reference || 'NO REF') + ' | ' + je.entryDate.toISOString().slice(0, 10) + ' | ' + je.status + ' | ' + je.description);
        console.log('    referenceType: ' + je.referenceType);
        console.log('    isAutoGenerated: ' + je.isAutoGenerated);
        je.lines.forEach(jl => {
            console.log('    ' + jl.account.code + ' ' + jl.account.name + ' | D:' + Number(jl.debit).toLocaleString() + ' C:' + Number(jl.credit).toLocaleString());
        });
        console.log('');
    });

    process.exit(0);
})();
